/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Website:  https://openfoam.org                  |
|   \\  /    A nd           | Version:  9                                     |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    format      ascii;
    class       dictionary;
    object      constitutiveProperties;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

rhoR 100.0;
visR 60.0;
slopeTan 0.050;
frNum 0.80;
reyNum #eval{3.0*$frNum*$frNum/$slopeTan};
waterRho 1.0;
airRho #eval{$waterRho/$rhoR};
DebNum 1.0;
rVis 0.50;
etaTotal #eval{1.0/$reyNum};
etaSVal #eval{$etaTotal*$rVis};
etaPVal #eval{$etaTotal-$etaSVal};
airEta #eval{$etaTotal/$visR};
weNum 0.01;

phases (water air);

water
{

  stabilization
  {
    // Diagonalization method
    diag            symmDiagQL;

    // Constitutive equation representation
    representation  rootConformationCorrectedSI;
    type            squareRoot;
    //k               4;

    // Fast back transformation
    diagonalization false;

    // Set alpha to 1 for both-sides-diffusion (BSD)
    alpha           0.0;
  }

  rheology
  {
    // Rheological model
    type           Oldroyd-B;

    // Solvent viscosity model
    solventViscosity
    {
      viscosityModel      constantEta;

      constantEtaCoeffs
      {
        eta            eta [1 -1 -1 0 0 0 0] $etaSVal;
      }
    }

    // Polymer properties
    polymerProperties
    {
      viscosityModel      constantEta;

      constantEtaCoeffs
      {
        eta            eta [1 -1 -1 0 0 0 0] $etaPVal;
      }

      relaxationModel     constantLambda;

      constantLambdaCoeffs
      {
        lambda          lambda [0 0 1 0 0 0 0] $DebNum;
      }
    }

    //epsilon          epsilon [0 0 0 0 0 0 0] 0.25;

    // Thermo properties
    thermoProperties
    {
      thermoModel     isoThermal;
    }

    // Fluid density
    rho             rho [1 -3 0 0 0 0 0] $waterRho;

  }
}

air
{
  rho             rho [1 -3 0 0 0 0 0] $airRho;

  viscosityProperties
  {
    viscosityModel      constantEta;

    constantEtaCoeffs
    {
      eta            eta [1 -1 -1 0 0 0 0] $airEta;
    }
  }
}

sigma               $weNum;
surfaceForces
{
  sigma	 $sigma;
  surfaceTensionForceModel RDF;//$STM;
  accelerationForceModel gravity;
  deltaFunctionModel alphaCSF;
}

// ************************************************************************* //
